<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="798px" height="619px" version="1.1" style="background-color: rgb(255, 255, 255);"><defs/><g transform="translate(0.5,0.5)"><ellipse cx="140" cy="340" rx="40" ry="39.5" fill="#ffffff" stroke="#000000" stroke-width="2" pointer-events="none"/><path d="M 408 20 C 408 9.33 468 9.33 468 20 L 468 64 C 468 74.67 408 74.67 408 64 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 408 20 C 408 28 468 28 468 20 M 408 24 C 408 32 468 32 468 24 M 408 28 C 408 36 468 36 468 28" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(408,38)"><switch><foreignObject pointer-events="all" width="59" height="30" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 57px; white-space: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Event Store</div></div></foreignObject><text x="30" y="21" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 407.56 106.12 C 407.77 105.45 408.46 105 409.23 105.02 L 457.51 105.02 L 462.5 112.71 L 457.51 120 L 409.11 120 C 408.65 119.98 408.22 119.78 407.93 119.46 C 407.63 119.14 407.5 118.72 407.56 118.31 Z M 408.67 118.17 C 408.8 118.67 409.31 119.02 409.89 119.01 L 457.01 119.01 L 461.39 112.71 L 457.01 105.97 L 409.89 105.97 C 409.39 105.92 408.9 106.16 408.67 106.56 Z M 410.34 108.55 C 410.38 108.09 410.77 107.72 411.28 107.65 L 423.6 107.65 C 424.11 107.72 424.5 108.09 424.54 108.55 L 424.54 116.68 C 424.4 117.07 424.01 117.35 423.54 117.37 L 411.39 117.37 C 410.93 117.35 410.53 117.07 410.39 116.68 Z M 411.83 110.43 L 411.83 116.18 L 423.15 116.18 L 423.15 110.33 L 417.94 113.85 C 417.57 114.07 417.09 114.07 416.72 113.85 Z M 417.38 112.76 L 422.93 108.89 L 411.89 108.89 Z M 426.1 108.55 C 426.12 108.13 426.43 107.78 426.87 107.65 L 439.36 107.65 C 439.8 107.78 440.11 108.13 440.14 108.55 L 440.14 116.68 C 440.03 117.02 439.74 117.28 439.36 117.37 L 426.87 117.37 C 426.49 117.28 426.2 117.02 426.1 116.68 Z M 427.48 110.38 L 427.48 116.18 L 438.8 116.18 L 438.75 110.38 L 433.64 113.85 C 433.25 114.12 432.71 114.12 432.31 113.85 Z M 433.03 112.76 L 438.64 108.89 L 427.48 108.89 Z M 441.75 108.55 C 441.79 108.09 442.18 107.72 442.69 107.65 L 454.95 107.65 C 455.46 107.72 455.85 108.09 455.9 108.55 L 455.9 116.48 C 455.87 116.74 455.72 116.99 455.49 117.15 C 455.26 117.32 454.97 117.4 454.68 117.37 L 442.69 117.37 C 442.25 117.33 441.88 117.06 441.75 116.68 Z M 443.08 110.38 L 443.08 116.18 L 454.4 116.18 L 454.4 110.38 L 449.18 113.85 C 448.84 114.03 448.41 114.03 448.07 113.85 Z M 448.68 112.76 L 454.23 108.89 L 443.13 108.89 Z" fill="#00bef2" stroke="none" pointer-events="none"/><g transform="translate(406,127)"><switch><foreignObject pointer-events="all" width="58" height="16" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div>BP stream</div></div></div></foreignObject><text x="29" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 437.52 72 L 437.1 97.8" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 437.02 103.05 L 433.63 95.99 L 437.1 97.8 L 440.63 96.11 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="435" cy="216" rx="39.5" ry="39.5" fill="#ffffff" stroke="#000000" stroke-width="2" pointer-events="none"/><g transform="translate(396,195)"><switch><foreignObject pointer-events="all" width="77" height="44" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 75px; white-space: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Saga Manager<div>[Receptor]</div></div></div></foreignObject><text x="39" y="28" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 435.33 169.47 L 435.33 120" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 435.33 174.72 L 431.83 167.72 L 435.33 169.47 L 438.83 167.72 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 193.4 215.83 L 395.33 215.83" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 199.28 212.33 L 192.28 215.83 L 199.28 219.33" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(282,210)"><switch><foreignObject pointer-events="all" width="33" height="16" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">Event</div></div></foreignObject><text x="17" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><ellipse cx="151" cy="216" rx="40" ry="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(113,210)"><switch><foreignObject pointer-events="all" width="75" height="16" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 75px; white-space: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Saga Office</div></div></foreignObject><text x="38" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 151 256 L 151.17 284.17 L 151.17 305.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.17 310.88 L 147.67 303.88 L 151.17 305.63 L 154.67 303.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(135,270)"><switch><foreignObject pointer-events="all" width="33" height="16" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">Event</div></div></foreignObject><text x="17" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(213,381)"><switch><foreignObject pointer-events="all" width="577" height="187" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 235px; max-width: 577px; width: 577px; white-space: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><h1>Saga</h1><p>Saga instance (Saga) represents particular business process instance (e.g. User Registration Process for user X). </p><p>Saga is persistent, event-sourced actor. State transition of the process is communicated by Saga by an event (like UserEmailConfirmed). Transitions are triggered by external events that Saga receives. </p><p>Saga is created or activated automatically by Saga Office whenever external event related (correlated) to this instance of business process is received by Saga Office.</p><p><span style="font-size: 10px ; line-height: 1.26">Sends commands to offices (at-least-once delivery).</span></p><p><span style="font-size: 10px ; line-height: 1.26">Schedules timeout/deadline events. </span><br /></p></div></div></foreignObject><text x="289" y="99" fill="#000000" text-anchor="middle" font-size="10px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><ellipse cx="151" cy="352" rx="39.5" ry="39.5" fill="#ffffff" stroke="#000000" stroke-width="2" pointer-events="none"/><g transform="translate(122,338)"><switch><foreignObject pointer-events="all" width="57" height="30" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 57px; white-space: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Saga<div>Instance</div></div></div></foreignObject><text x="29" y="21" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><ellipse cx="151" cy="43" rx="39.5" ry="39.5" fill="#ffffff" stroke="#000000" stroke-width="2" pointer-events="none"/><g transform="translate(129,36)"><switch><foreignObject pointer-events="all" width="43" height="16" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 43px; white-space: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Office</div></div></foreignObject><text x="22" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(499,126)"><switch><foreignObject pointer-events="all" width="291" height="199" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 290px; max-width: 291px; width: 291px; white-space: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><h1>Saga Manager</h1><p>Responsible for reliable delivery of events to Saga Office.</p><p>Receives events from defined BPS.</p><p>Obtains correlationId resolver - function that maps an event to saga id (eg. UserCreated(userId: EntityId, ...) =&gt; userId) from SagaConfig.</p><p><span style="font-size: 10px ; line-height: 1.26">Forwards incoming events to Saga Office.</span></p><p>Is cluster-wide singleton automatically created when Saga class is registered (see: SagaSupport)</p></div></div></foreignObject><text x="146" y="105" fill="#000000" text-anchor="middle" font-size="10px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(213,274)"><switch><foreignObject pointer-events="all" width="207" height="87" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 100px; max-width: 207px; width: 207px; white-space: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><h1>Saga Office</h1><p>Standard Office that is automatically created for Saga class (See: SagaSupport)</p></div></div></foreignObject><text x="104" y="49" fill="#000000" text-anchor="middle" font-size="10px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(500,0)"><switch><foreignObject pointer-events="all" width="290" height="123" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 134px; max-width: 290px; width: 290px; white-space: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><h1>Business Process Stream (BPS)</h1><p>Stream of events particular business process (eg. User Registration) <span style="line-height: 1.26">is interested in. The stream is fed by projections that listen to events coming from one or more business offices.</span></p></div></div></foreignObject><text x="145" y="67" fill="#000000" text-anchor="middle" font-size="10px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 172 134.17 L 290.33 134.17 L 290.33 41.67 L 401.47 41.67" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 406.72 41.67 L 399.72 45.17 L 401.47 41.67 L 399.72 38.17 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(274,99)"><switch><foreignObject pointer-events="all" width="33" height="16" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">Event</div></div></foreignObject><text x="17" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 111.17 351.67 L 25.33 351.67 L 25.33 42.5 L 104.8 42.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 110.05 42.5 L 103.05 46 L 104.8 42.5 L 103.05 39 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(0,179)"><switch><foreignObject pointer-events="all" width="57" height="16" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">Command</div></div></foreignObject><text x="29" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><ellipse cx="141" cy="124" rx="21" ry="21" fill="#ffffff" stroke="#000000" pointer-events="none"/><ellipse cx="151" cy="134" rx="21" ry="21" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(136,128)"><switch><foreignObject pointer-events="all" width="29" height="16" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 29px; white-space: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">AR</div></div></foreignObject><text x="15" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 151.17 81.67 L 151.17 106.97" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 151.17 112.22 L 147.67 105.22 L 151.17 106.97 L 154.67 105.22 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(122,88)"><switch><foreignObject pointer-events="all" width="57" height="16" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">Command</div></div></foreignObject><text x="29" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g></g></svg>